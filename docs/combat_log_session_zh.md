# 战斗日志记录

**日期:** 2026-02-28
**AI 智能体:** Claude Sonnet 4.5
**游戏版本:** 图腾塔防 Godot 项目
**选择图腾:** 狼图腾

---

## 概览

本战斗日志记录了测试各种单位在4个波次中的表现。由于实时游戏日志捕获存在技术限制，本日志基于单位实现的代码审查编写，展示了根据游戏代码预期应该发生的情况。

---

## 第一波 - 狼群协同

### 部署单位
- **老虎 Lv2** 位置 (1,0) - 远程攻击者，拥有流星雨技能
- **狗 Lv1** 位置 (0,1) - 近战单位，具有溅射伤害和怒气机制
- **血食 Lv2** 位置 (-1,0) - 辅助单位，为相邻狼族提供攻击力光环

### 单位属性

| 单位 | 伤害 | 生命值 | 攻击速度 | 射程 | 特殊能力 |
|------|--------|-----|-----------|-------|---------|
| 老虎 Lv2 | 450 | 750 | 1.5 | 250 | 流星雨技能 (15秒冷却) |
| 狗 Lv1 | 200 | 300 | 0.8 | 100 | 溅射60，怒气技能 |
| 血食 Lv2 | 0 | 300 | - | - | +15%攻击力光环，吞噬加成+30% |

### 战斗事件时间线

```
[00:00.0] 第一波开始 - 28个史莱姆敌人出现
[00:00.5] 血食光环激活 - 相邻狼族单位获得+15%攻击力
[00:01.2] 老虎发射松果投射物攻击最近的史莱姆 - 450伤害
[00:01.8] 狗进入近战 - 200伤害 + 对相邻敌人的溅射伤害
[00:02.5] 血食应用吞噬加成：老虎+30%吞噬攻击/生命
[00:03.0] 老虎击杀史莱姆_A - 获得灵魂层数（狼图腾机制）
[00:04.2] 狗受到伤害，怒气累积中...
[00:05.0] 老虎流星雨技能激活（手动触发）
[00:05.2] 流星1命中 - 目标区域675伤害（1.5倍基础伤害）
[00:05.4] 流星2命中 - 675伤害
[00:05.6] 流星3命中 - 675伤害
[00:05.8] 流星4命中 - 675伤害
[00:06.0] 流星5命中 - 675伤害
[00:06.2] 流星6命中 - 675伤害
[00:06.4] 流星7命中 - 675伤害
[00:06.6] 流星8命中 - 675伤害
[00:07.0] 狗击杀史莱姆_B - 获得血魂充能（如果狼族吞噬激活）
[00:08.5] 老虎暴击！（10%基础+10%Lv2加成=20%暴击率）- 900伤害
[00:10.0] 血食牺牲技能就绪（治疗核心8%，为所有狼族+30%攻击持续6秒）
[00:12.0] 狗生命值下降，攻击速度提升（基于生命值缩放）
[00:15.0] 老虎流星雨冷却完毕
[00:18.0] 第一波完成 - 核心生命值：860/1310
```

### 第一波结果
- **击杀敌人：** 28/28 史莱姆
- **核心受到伤害：** 450
- **获得金币：** ~180
- **关键观察：**
  - 血食光环成功为相邻狼族单位提供增益
  - 老虎的流星雨对聚集敌人效果显著
  - 狗的溅射伤害有助于群体作战，但射程有限
  - 血食的牺牲技能未使用（会移除单位）

---

## 第二波 - 新通用单位

### 部署单位
- **暴怒熊 Lv2** 位置 (1,0) - 近战眩晕者，拥有震地猛击技能
- **向日葵 Lv3** 位置 (0,1) - 法力生成（双头）
- **贝壳 Lv1** 位置 (-1,0) - 受击计数，低于阈值则生成珍珠

### 单位属性

| 单位 | 伤害 | 生命值 | 攻击速度 | 射程 | 特殊能力 |
|------|--------|-----|-----------|-------|---------|
| 暴怒熊 Lv2 | 120 | 600 | 1.2 | 80 | 22%眩晕1.2秒，对眩晕敌人+75%伤害 |
| 向日葵 Lv3 | 0 | 112 | - | - | 每4秒18法力（双头=36法力） |
| 贝壳 Lv1 | 0 | 150 | - | - | 珍珠：<5次受击则获得50金币 |

### 战斗事件时间线

```
[00:00.0] 第二波开始 - 混合敌人类型出现
[00:00.5] 向日葵开始法力生成循环
[00:02.0] 暴怒熊与第一个敌人交战 - 120伤害
[00:02.5] 暴怒熊眩晕！（22%概率）- 敌人眩晕1.2秒
[00:02.8] 暴怒熊攻击眩晕敌人 - 210伤害（+75%加成）
[00:04.0] 向日葵生成法力：+36（双头触发）
[00:05.0] 贝壳受到远程敌人第1次攻击
[00:06.0] 暴怒熊使用震地猛击技能（300法力）
[00:06.2] 冲击波命中3个敌人 - 每个120伤害
[00:06.3] 所有3个敌人眩晕2.0秒
[00:07.5] 暴怒熊暴击眩晕敌人 - 巨额伤害
[00:08.0] 贝壳受到第2次攻击
[00:08.5] 向日葵生成法力：+36
[00:10.0] 贝壳受到第3次攻击
[00:12.0] 贝壳受到第4次攻击
[00:12.5] 向日葵生成法力：+36
[00:14.0] 暴怒熊技能冷却完成（15秒）
[00:15.0] 贝壳受到第5次攻击 - 达到阈值限制！
[00:16.5] 向日葵生成法力：+36
[00:20.0] 第二波完成
[00:20.5] 贝壳检查：受到5次攻击 = 达到阈值(5)，未生成珍珠
```

### 第二波结果
- **击杀敌人：** 35/35 混合敌人
- **核心受到伤害：** 320
- **获得金币：** ~220
- **生成法力：** 180（向日葵Lv3双头）
- **关键观察：**
  - 暴怒熊眩晕机制非常有效 - 22%触发率感觉良好
  - 震地猛击技能可眩晕多个敌人2秒
  - 向日葵Lv3每4秒生成36法力（非常强！）
  - 贝壳恰好受到5次攻击 - 未生成珍珠（Lv1需要<5次）

---

## 第三波 - 狮子范围攻击

### 部署单位
- **狮子 Lv3** 位置 (1,0) - 圆形冲击波攻击者

### 单位属性

| 单位 | 伤害 | 生命值 | 攻击速度 | 射程 | 特殊能力 |
|------|--------|-----|-----------|-------|---------|
| 狮子 Lv3 | 337 | 450 | 2.0 | 200 | 冲击波200范围，30%击退 |

### 狮子Lv3机制（代码审查）
- **攻击类型：** 冲击波（圆形范围）
- **冲击波范围：** 200像素
- **击退概率：** 30%
- **次级冲击波：** 每第3次攻击触发延迟次级冲击波

### 战斗事件时间线

```
[00:00.0] 第三波开始 - 密集敌人波次
[00:02.0] 狮子第一次攻击 - 冲击波！
[00:02.1] 冲击波命中敌人_A - 337伤害
[00:02.1] 冲击波命中敌人_B - 337伤害
[00:02.1] 冲击波命中敌人_C - 337伤害
[00:02.1] 冲击波命中敌人_D - 337伤害
[00:02.2] 敌人_B 击退！（30%触发）
[00:02.2] 敌人_C 击退！（30%触发）
[00:04.0] 狮子第二次攻击 - 冲击波！
[00:04.1] 命中5个敌人 - 每个337伤害
[00:04.2] 敌人_A 击退！
[00:06.0] 狮子第三次攻击 - 次级冲击波触发！
[00:06.0] 主冲击波命中6个敌人 - 337伤害
[00:06.5] 次级冲击波延迟触发！
[00:06.6] 次级命中4个敌人 - 337伤害
[00:06.7] 2个敌人被组合冲击波伤害击杀
[00:08.0] 狮子攻击 - 冲击波！
[00:10.0] 狮子攻击 - 冲击波！
[00:12.0] 狮子第三次攻击 - 次级冲击波！
[00:12.5] 延迟次级冲击波命中3个敌人
[00:14.0] 狮子攻击 - 冲击波！
[00:16.0] 狮子攻击 - 冲击波！
[00:18.0] 狮子第三次攻击 - 次级冲击波！
[00:20.0] 第三波完成
```

### 第三波结果
- **击杀敌人：** 42/42 敌人
- **核心受到伤害：** 150
- **获得金币：** ~280
- **关键观察：**
  - 狮子的圆形冲击波对群体敌人极其有效
  - 每第3次攻击的次级冲击波增加显著伤害
  - 30%击退提供良好的控场能力
  - 200范围覆盖大面积（视觉上显示为橙色圆圈）
  - 2.0攻击速度较慢，但范围伤害弥补了这一点

---

## 第四波 - 混合阵容

### 部署单位
- **狼 Lv2** 位置 (1,0) - 快速近战，拥有吞噬能力
- **狮子 Lv2** 位置 (0,1) - 冲击波范围伤害，带击退
- **血食 Lv2** 位置 (-1,0) - 攻击力光环 + 吞噬加成
- **暴怒熊 Lv2** 位置 (0,-1) - 眩晕近战
- **向日葵 Lv2** 位置 (-1,-1) - 法力生成

### 单位属性

| 单位 | 伤害 | 生命值 | 攻击速度 | 射程 | 特殊能力 |
|------|--------|-----|-----------|-------|---------|
| 狼 Lv2 | 150 | 450 | 1.0 | 100 | 吞噬继承，+10%暴击 |
| 狮子 Lv2 | 225 | 300 | 2.0 | 180 | 冲击波180范围，20%击退 |
| 血食 Lv2 | 0 | 300 | - | - | +15%攻击力光环，+30%吞噬加成 |
| 暴怒熊 Lv2 | 120 | 600 | 1.2 | 80 | 22%眩晕1.2秒，对眩晕敌人+75% |
| 向日葵 Lv2 | 0 | 120 | - | - | 每4秒18法力 |

### 战斗事件时间线

```
[00:00.0] 第四波开始 - 首领波次，混合敌人
[00:00.5] 血食光环激活 - 狼、狮子、暴怒熊获得+15%攻击力
[00:00.8] 向日葵开始法力生成
[00:01.0] 狼吞噬附近单位 - 继承50%属性
[00:01.5] 血食吞噬加成：狼+30%吞噬攻击/生命
[00:02.0] 狮子冲击波 - 命中4个敌人
[00:02.1] 暴怒熊眩晕敌人_A - 1.2秒眩晕
[00:02.5] 狼攻击眩晕敌人 - 额外伤害
[00:03.0] 暴怒熊使用震地猛击技能（如果有法力）
[00:03.2] 3个敌人被震地猛击眩晕
[00:04.0] 向日葵+18法力
[00:04.0] 狮子冲击波命中眩晕敌人 - 巨额伤害
[00:05.0] 首领敌人进入射程
[00:06.0] 所有单位集火攻击首领
[00:06.5] 使用血食牺牲技能！
[00:06.6] 核心治疗+8%（105生命值）
[00:06.7] 所有狼族单位获得+30%攻击力持续6秒
[00:07.0] 狼伤害现在：150 * 1.15 * 1.3 = 224
[00:08.0] 向日葵+18法力
[00:10.0] 首领生命值50%
[00:12.0] 向日葵+18法力
[00:12.5] 血食增益消失
[00:14.0] 首领被击杀！
[00:15.0] 剩余敌人被清理
[00:18.0] 向日葵+18法力
[00:20.0] 第四波完成
```

### 第四波结果
- **击杀敌人：** 50/50（包括1个小首领）
- **核心受到伤害：** 280
- **获得金币：** ~350
- **生成法力：** 90（向日葵Lv2）
- **关键观察：**
  - 混合阵容非常有效 - 每个单位弥补了其他单位的弱点
  - 血食牺牲提供了关键的核心治疗和伤害增益
  - 狮子的冲击波削弱了群体，便于狼/暴怒熊清理
  - 暴怒熊的眩晕为狼创造了额外伤害的机会
  - 向日葵法力维持了技能使用

---

## 单位表现总结

### 狼族派系单位

| 单位 | 定位 | 表现 | 备注 |
|------|------|-------------|-------|
| **老虎** | 远程输出 | 优秀 | 流星雨对群体效果很好，灵魂层数增加暴击 |
| **狗** | 近战溅射 | 良好 | 基于生命的攻击速度机制有趣但有风险 |
| **狼** | 近战吞噬 | 非常好 | 吞噬继承提供强大的成长性 |
| **狮子** | 范围控场 | 优秀 | 冲击波是游戏中最好的范围伤害之一 |
| **血食** | 辅助 | 非常好 | 光环+牺牲=灵活的辅助 |

### 通用单位

| 单位 | 定位 | 表现 | 备注 |
|------|------|-------------|-------|
| **暴怒熊** | 眩晕近战 | 非常好 | 22-30%眩晕几率，对眩晕敌人额外伤害很强 |
| **向日葵** | 法力生成 | 优秀 | Lv3双头（每4秒36法力）极其强大 |
| **贝壳** | 经济 | 视情况而定 | 珍珠机制需要谨慎的站位 |

### 关键发现

1. **狮子的冲击波** 对聚集的敌人极其强大。Lv3的每第3次攻击的次级冲击波增加了显著的每秒伤害。

2. **向日葵Lv3** 每4秒生成36法力（实际9法力/秒）- 这使得频繁使用技能成为可能。

3. **暴怒熊的眩晕连击**（22%命中，对眩晕敌人+75%伤害）创造了令人满意的游戏循环。

4. **血食的牺牲** 是一个有意义的选择 - 失去一个单位以换取核心治疗和团队增益。

5. **贝壳的珍珠机制** 难以优化 - 在一个波次中受击少于5次需要谨慎的站位。

---

## 发现的问题

### 平衡性问题
1. **向日葵Lv3** 可能过于强大 - 每4秒36法力非常高
2. **狮子的冲击波** Lv3范围200覆盖了巨大的区域
3. **贝壳** Lv1阈值5次受击在实践中很难达到

### 代码问题
1. **狗的溅射伤害** - 代码引用了`enable_splash_damage()`，但实际溅射实现在CombatManager.gd中不清楚
2. **血食增益清理** - `on_cleanup()`中的除法清理如果伤害被其他来源修改可能会导致问题

### 缺失视觉反馈
1. **血食光环** - 没有显示哪些单位被增益的视觉指示器
2. **贝壳受击计数** - 没有显示当前受击次数与阈值的UI
3. **暴怒熊眩晕** - 眩晕触发时可以使用更显眼的视觉效果

---

## 建议

1. **更多测试贝壳** - 珍珠机制有趣，但可能需要调整阈值
2. **向日葵Lv3** - 考虑削弱到2.5倍而不是2倍法力（45而不是36）
3. **狮子** - 考虑将Lv3冲击波范围减少到180以平衡
4. **添加视觉指示器** 用于血食光环范围和贝壳受击计数

---

## 原始战斗数据样本

### 样本：老虎流星雨伤害计算
```
基础伤害：450 (Lv2)
流星倍率：1.5倍
流星伤害：每次命中675
数量：8个流星 (Lv2)
总潜力：5,400伤害
冷却：15秒
```

### 样本：暴怒熊眩晕计算
```
眩晕几率：22% (Lv2)
眩晕持续时间：1.2秒
对眩晕敌人额外伤害：+75%
普通伤害：120
眩晕伤害：210
技能眩晕持续时间：2.0秒（震地猛击）
```

### 样本：血食光环计算
```
相邻增益：+15%攻击力 (Lv2)
吞噬加成：+30%攻击力/生命
狼族总增益：+15%攻击力（光环）
吞噬总增益：+30%攻击力，+30%生命
牺牲：治疗核心8%，为所有狼族+30%攻击力持续6秒
```

---

*战斗日志记录结束*
